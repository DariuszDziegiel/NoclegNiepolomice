var fixHelper=function(e,r){return r.children().each(function(){$(this).width($(this).width())}),r};$(document).ready(function(){function e(e,r){var a=e.data("prototype"),o=e.data("index"),n=a.replace(/__name__/g,o);e.data("index",o+1);var t=$('<div class="form-group new-formula-wrapper"></div>').append(n);t.append('<button type="button" class="btn btn-sm btn-danger remove-formula pull-right" ><span class="glyphicon glyphicon-remove"></span> Usuń</button>'),t.append("<hr />"),r.before(t)}var r,a=$("<div></div>");r=$(".base-room-formulas-wrapper"),r.append(a),r.data("index",r.find(":input").length),$("#base-room-formula-add-btn").on("click",function(o){o.preventDefault(),e(r,a)}),r.on("click",".remove-formula",function(e){if(e.preventDefault(),confirm("Usunąć wybrany wzór ?"))return $(this).closest(".form-group").remove(),!1}),$(".uploadify-files-wrapper, .document-files-wrapper").on("click",".remove-file-btn",function(){var e=$(this).data("file-id");bootbox.confirm(Translator.trans("msg.file_remove_confirm"),function(r){r&&(LoaderBg.add("body","Trwa kasowanie pliku"),$.ajax({method:"GET",url:Routing.generate("rs_room_file_remove",{id:e}),dataType:"json"}).done(function(r){r.success?$(".uploadify-file[data-file-id="+e+"]").fadeOut():alert(Translator.trans("msg.file_remove_error")),LoaderBg.remove()}).fail(function(){alert(Translator.trans("msg.file_remove_error")),LoaderBg.remove()}))})}),$(".uploadify-files-wrapper").sortable({helper:fixHelper,update:function(){serial=$(this).sortable("serialize"),LoaderBg.add("body","Trwa zmiana kolejności"),$.ajax({url:Routing.generate("rs_room_file_sort"),type:"POST",dataType:"json",data:{serial:serial},error:function(){LoaderBg.remove(),bootbox.alert("Bład sortowania")},success:function(){LoaderBg.remove(),bootbox.alert("Kolejność została zmieniona")}})}})});